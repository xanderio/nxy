{
  "db": "PostgreSQL",
  "02ccdd5994dc03a27d8ab60d769410589dd9f1f3286245a039076ff43e572485": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid"
        ]
      }
    },
    "query": "insert into agents (agent_id) values ($1)"
  },
  "165c6e3db988a5debb7881536b630b1067c5fc33ad957b12ba9e37a23eaaf69d": {
    "describe": {
      "columns": [
        {
          "name": "nixos_configuration_id",
          "ordinal": 0,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Int8",
          "Text"
        ]
      }
    },
    "query": "\n            SELECT nixos_configuration_id FROM nixos_configurations\n            WHERE flake_id = $1 AND name = $2\n            "
  },
  "3bd52fe6c283e21c1c5b12f1f69114837d1552afa4efab3128242df3a4edc299": {
    "describe": {
      "columns": [
        {
          "name": "agent_id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid"
        ]
      }
    },
    "query": "select agent_id from agents where agent_id = $1"
  },
  "47fc82cbeae563a394bf44aabc53ac7f13ee5fc6dc697ca78b1ce981564c2736": {
    "describe": {
      "columns": [
        {
          "name": "flake_id",
          "ordinal": 0,
          "type_info": "Int8"
        },
        {
          "name": "flake_url",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "flake_revision_id!",
          "ordinal": 2,
          "type_info": "Int8"
        },
        {
          "name": "revision",
          "ordinal": 3,
          "type_info": "Text"
        },
        {
          "name": "last_modified",
          "ordinal": 4,
          "type_info": "Timestamptz"
        },
        {
          "name": "url",
          "ordinal": 5,
          "type_info": "Text"
        }
      ],
      "nullable": [
        false,
        false,
        null,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": []
      }
    },
    "query": "\n        with last_rev as (\n            select flake_id, max(flake_revision_id) as flake_revision_id\n            from flake_revisions\n            group by flake_id\n        )\n        select flakes.flake_id, flake_url, flake_revision_id as \"flake_revision_id!\", revision, last_modified, url\n        from flakes\n        join last_rev using (flake_id)\n        join flake_revisions using (flake_revision_id)\n        "
  },
  "6511574c0bf23e5326ae335549bc11db0e5960f783fb9f7c672d3ac8a003c446": {
    "describe": {
      "columns": [
        {
          "name": "flake_id",
          "ordinal": 0,
          "type_info": "Int8"
        },
        {
          "name": "flake_url",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "revision",
          "ordinal": 2,
          "type_info": "Text"
        },
        {
          "name": "last_modified",
          "ordinal": 3,
          "type_info": "Timestamptz"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": []
      }
    },
    "query": "\n        WITH last_rev AS (\n            SELECT flake_id, MAX(flake_revision_id) AS flake_revision_id\n            FROM flake_revisions\n            GROUP BY flake_id\n        )\n        SELECT flakes.flake_id, flake_url, revision, last_modified \n        FROM flakes\n        JOIN last_rev USING (flake_id)\n        JOIN flake_revisions USING (flake_revision_id)\n        "
  },
  "6ef91119dff3cd34d85881a28a59e28c4350b4651d63b50be11051aac0aaa8da": {
    "describe": {
      "columns": [
        {
          "name": "flake_id",
          "ordinal": 0,
          "type_info": "Int8"
        },
        {
          "name": "url",
          "ordinal": 1,
          "type_info": "Text"
        }
      ],
      "nullable": [
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Int8"
        ]
      }
    },
    "query": "SELECT flake_id, url FROM flake_revisions WHERE flake_revision_id = $1"
  },
  "8cd2b188f73142e0f1029ed187f7671f4ed60104e5aa6028345c347ba4e8a42e": {
    "describe": {
      "columns": [
        {
          "name": "flake_revision_id",
          "ordinal": 0,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Int8",
          "Text",
          "Timestamptz",
          "Text",
          "Jsonb"
        ]
      }
    },
    "query": "\n            INSERT INTO flake_revisions (flake_id, revision, last_modified, url, metadata)\n            VALUES ($1, $2, $3, $4, $5)\n            RETURNING flake_revision_id\n            "
  },
  "901827a3edfb6b3b09676ea976461d23126921fcc6514213fadc1feaf0131475": {
    "describe": {
      "columns": [
        {
          "name": "flake_id",
          "ordinal": 0,
          "type_info": "Int8"
        },
        {
          "name": "flake_url",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "flake_revision_id",
          "ordinal": 2,
          "type_info": "Int8"
        },
        {
          "name": "revision",
          "ordinal": 3,
          "type_info": "Text"
        },
        {
          "name": "last_modified",
          "ordinal": 4,
          "type_info": "Timestamptz"
        },
        {
          "name": "url",
          "ordinal": 5,
          "type_info": "Text"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Text",
          "Text",
          "Timestamptz",
          "Text",
          "Jsonb"
        ]
      }
    },
    "query": "\n            with inserted_flake as (\n                insert into flakes (flake_url)\n                values ($1)\n                returning flake_id, flake_url\n            ), inserted_revision as (\n                insert into flake_revisions (flake_id, revision, last_modified, url, metadata)\n                select flake_id, $2, $3, $4, $5\n                from inserted_flake\n                returning flake_revision_id, revision, last_modified, url\n            )\n            select flake_id, flake_url, flake_revision_id, revision, last_modified, url\n            from inserted_flake, inserted_revision\n        "
  },
  "bc071afcbbc3d4c41e8aaa90145ae531a55214e15c0f996461aef3ecf60ff824": {
    "describe": {
      "columns": [
        {
          "name": "nixos_configuration_id",
          "ordinal": 0,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Int8",
          "Text"
        ]
      }
    },
    "query": "\n        INSERT INTO nixos_configurations (flake_id, name)\n        VALUES ($1, $2) \n        ON CONFLICT DO NOTHING\n        RETURNING nixos_configuration_id\n        "
  },
  "c591ba80c33c36015e66b3b02373b3ad853e64e032278ae4db76f4e15502570e": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Text"
        ]
      }
    },
    "query": "update agents set current_system = $2 where agent_id = $1"
  },
  "ffc37a9ec8bf0c7560f5d30d3c0cca8ad263f0a62a7b8ad8fe8249e6e528a54a": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Int8",
          "Int8",
          "Text"
        ]
      }
    },
    "query": "\n        INSERT INTO nixos_configuration_evaluations (flake_revision_id, nixos_configuration_id, store_path)\n        VALUES ($1, $2, $3) \n        "
  }
}